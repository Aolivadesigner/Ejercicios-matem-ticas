<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Animales filtrables por categoría</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #333; padding: 8px; text-align: center; }
    th { background-color: #4CAF50; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    .filtros { margin-bottom: 10px; }
    .filtros label { margin-right: 15px; }
  </style>
</head>
<body>
  <h1>Animales y propiedades</h1>

  <div class="filtros">
    <label>Buscar nombre: <input type="text" id="buscarNombre" placeholder="Escribe el nombre..."></label>
    <label>Categoría:
      <select id="filtroCategoria">
        <option value="">Todas</option>
        <option value="vertebrado">Vertebrado</option>
        <option value="invertebrado">Invertebrado</option>
      </select>
    </label>
    <label>Subcategoría:
      <select id="filtroSubcategoria">
        <option value="">Todas</option>
        <option value="mamifero">Mamífero</option>
        <option value="ave">Ave</option>
        <option value="reptil">Reptil</option>
        <option value="pez">Pez</option>
        <option value="insecto">Insecto</option>
        <option value="aracnido">Arácnido</option>
        <option value="molusco">Molusco</option>
      </select>
    </label>
  </div>

  <table id="tablaAnimales">
    <thead>
      <tr>
        <th>Animal</th>
        <th>Patas</th>
        <th>Pico</th>
        <th>Alas</th>
        <th>Categoría</th>
        <th>Subcategoría</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script type="module">
    import animales from "../diccionario/animalProps.json" assert { type: "json" };

    const tbody = document.querySelector("#tablaAnimales tbody");
    const inputNombre = document.getElementById("buscarNombre");
    const filtroCategoria = document.getElementById("filtroCategoria");
    const filtroSubcategoria = document.getElementById("filtroSubcategoria");

    function renderizarTabla() {
      const nombreFiltro = inputNombre.value.toLowerCase();
      const catFiltro = filtroCategoria.value;
      const subcatFiltro = filtroSubcategoria.value;

      tbody.innerHTML = "";

      Object.entries(animales).forEach(([animal, props]) => {
        if(nombreFiltro && !animal.toLowerCase().includes(nombreFiltro)) return;
        if(catFiltro && props.categoria !== catFiltro) return;
        if(subcatFiltro && props.subcategoria !== subcatFiltro) return;

        const tr = document.createElement("tr");

        ["patas", "pico", "alas"].forEach(prop => {
          const td = document.createElement("td");
          td.textContent = props[prop];
          tr.appendChild(td);
        });

        const tdNombre = document.createElement("td");
        tdNombre.textContent = animal;
        tr.insertBefore(tdNombre, tr.firstChild);

        const tdCat = document.createElement("td");
        tdCat.textContent = props.categoria;
        tr.appendChild(tdCat);

        const tdSub = document.createElement("td");
        tdSub.textContent = props.subcategoria;
        tr.appendChild(tdSub);

        tbody.appendChild(tr);
      });
    }

    inputNombre.addEventListener("input", renderizarTabla);
    filtroCategoria.addEventListener("change", renderizarTabla);
    filtroSubcategoria.addEventListener("change", renderizarTabla);

    // Inicial
    renderizarTabla();
  </script>
</body>
</html>